###目的:
本来想方便用户,把tomcat的端口号从8080改成80,从而用户可以直接访问域名,但是中间出了一些小插曲:
比如我在localhost(win10)下通过eclipse或者直接修改server.xml文件的端口号都是ok的,但是此方法用到centos服务器上就出现悲剧了:不仅不生效,把端口改回8080也无法启动服务,o(╯□╰)o,百思不得姐,只得重装了一遍tomcat,然后之间又经历了jdk环境崩溃,ftp速率降到冰点,电饭煲上的午饭烧焦等尴尬,最终终于装好了,,,
百度不成,终于在谷歌上找到原因和解决方案:
###原因:
因为Linux限制了1-1024端口的使用权限，只有root用户才可以访问1024以下的端口号(咦?我就是root登录的啊???)
###替代方案:
>iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-port 8080

利用防火墙的端口映射把8080端口引到80上(浏览器默认端口号),从而实现了端口号对用户透明的效果,虽然这个办法不完美,但也算长见识了,之于Apache的/var/www/html目录我至今不知道只能处理静态网页的web服务器有什么用,只能抛弃了.

![这里写图片描述](https://image-store.slidesharecdn.com/099cd3a3-3795-46b9-91f1-0c431f3f8e30-original.jpeg)
###关于路径映射
开发者既要考虑到服务器的真实路径也要设计面向用户的虚拟路径,这两种路径的映射关系是在web.xml中设置的,除此之外,由于webapps目录有多个应用,但通常只用一个,所以还需要把服务器的根目录映射到这个应用的根目录:注意,对于浏览器来说,根目录是"www.openidea.xin:8080/",但是对于应用内部,根目录是"www.openidea.xin:8080/Blog"
##总结
端口映射和路径映射,当然还有虚拟主机映射(没谈到,下一次专门撰文介绍),这些映射关系的合理设计是网站引流的重要因素.